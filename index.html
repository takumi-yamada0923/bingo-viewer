<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Bingo Viewer</title>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <style>
    body {
      font-family: sans-serif;
      padding: 10px;
    }

    h2 {
      font-size: 2em;
    }

    .team-setting {
      margin-bottom: 20px;
      padding-left: 10px;
    }

    .team-setting h3 {
      font-size: 1.8em;
      margin-bottom: 5px;
    }

    .setting-row {
      font-size: 2em;
      margin-left: 20px;
      margin-top: 5px;
    }

    .url-input, .team-input {
      font-size: 1em;
      padding: 5px;
      width: 80%;
      max-width: 600px;
    }

    .make-btn {
      font-size: 1.5em;
      padding: 10px 20px;
      margin-bottom: 30px;
    }

    .frames {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }

    .frame-box {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .team-label {
      font-size: 1.5em;
      font-weight: bold;
      margin-bottom: 5px;
    }

    iframe {
      width: 500px;
      height: 700px;
      border: 1px solid #999;
    }
  </style>
</head>
<body>

<h2>設定</h2>

<div class="team-setting">
  <h3>チーム①</h3>
  <div class="setting-row">
    チーム名：
    <input id="team1" placeholder="チームA" class="team-input">
  </div>
  <div class="setting-row">
    URL：
    <input id="url1" placeholder="URL1" class="url-input">
  </div>
</div>

<div class="team-setting">
  <h3>チーム②</h3>
  <div class="setting-row">
    チーム名：
    <input id="team2" placeholder="チームB" class="team-input">
  </div>
  <div class="setting-row">
    URL：
    <input id="url2" placeholder="URL2" class="url-input">
  </div>
</div>

<button class="make-btn" onclick="openBingoMaker()">ビンゴURLを作成（別タブ）</button>

<hr>

<div class="frames">
  <div class="frame-box">
    <div class="team-label" id="label1">チームA</div>
    <iframe id="frame1"></iframe>
  </div>
  <div class="frame-box">
    <div class="team-label" id="label2">チームB</div>
    <iframe id="frame2"></iframe>
  </div>
</div>

<script>
  // Firebase設定
  const firebaseConfig = {
    apiKey: "AIzaSyB-qPzDHJSnRHNHKvNdD-sTu6v1-sRnilI",
    authDomain: "zatsudan-mate.firebaseapp.com",
    databaseURL: "https://zatsudan-mate-default-rtdb.firebaseio.com",
    projectId: "zatsudan-mate",
    storageBucket: "zatsudan-mate.firebasestorage.app",
    messagingSenderId: "1008942200664",
    appId: "1:1008942200664:web:191aa9a2cca34ff32f972d",
    measurementId: "G-JSPJDPL1P1"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  function openBingoMaker() {
    window.open("https://kumamate.net/bingo/", "_blank");
  }

  function saveUrls() {
    db.ref("urls").set({
      team1: document.getElementById("team1").value || "チームA",
      team2: document.getElementById("team2").value || "チームB",
      url1: document.getElementById("url1").value,
      url2: document.getElementById("url2").value
    });
  }

  ["url1","url2","team1","team2"].forEach(id => {
    document.getElementById(id).addEventListener("change", saveUrls);
    document.getElementById(id).addEventListener("paste", () => {
      setTimeout(saveUrls, 100);
    });
  });

  // Firebaseから反映
  db.ref("urls").on("value", snap => {
    const data = snap.val();
    if (!data) return;

    document.getElementById("team1").value = data.team1 || "";
    document.getElementById("team2").value = data.team2 || "";
    document.getElementById("url1").value = data.url1 || "";
    document.getElementById("url2").value = data.url2 || "";

    // ★ iframe上のチーム名も入力値と同期
    document.getElementById("label1").textContent = data.team1 || "チームA";
    document.getElementById("label2").textContent = data.team2 || "チームB";

    document.getElementById("frame1").src = data.url1 || "";
    document.getElementById("frame2").src = data.url2 || "";
  });
</script>

</body>
</html>
